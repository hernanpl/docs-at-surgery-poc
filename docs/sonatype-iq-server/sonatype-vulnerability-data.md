---
layout: default
title: "Sonatype Vulnerability Data"
parent: Sonatype IQ Server
nav_order: 10
---

# Sonatype Vulnerability Data

Sonatype creates data using a proprietary, automated vulnerability detection system that monitors, aggregates, correlates, and incorporates machine learning from publicly available information. The Sonatype Data Research team does not just aggregate public security feeds — we create the precise data we use.

Sonatype uses a variety of public information as an input to our security platform (human research and automated data synthesis systems), such as:

- NVD, GHSA, Friends of PHP, Tomcat, Spring, OSV, Fedora, Oracle, RedHat, GitLab, HackerOne, VMWare, ExploitDB, RubySec, CloudBees, Mono Vulnerabilities, ExpressJS, CERT, 18+ Apache projects, Safety DB, RustSec, Huntr Hacktivity, GitHub events, X (formally known as Twitter), blogs, and customer reports.

We have evaluated paid-for services and found the quality and precision of the data to be of limited value, driving our decision to build an intelligent, automated vulnerability detection system.

Not all security data is created equal and most data is incomplete. Many times the “incomplete” data is missing vulnerabilities, and automation is not sufficient to identify this missing information. We’ve found that [92% of crowdsourced or publicly available vulnerability data needed a correction](https://www.sonatype.com/state-of-the-software-supply-chain/2024/optimization) once detailed security research took place. Data is highly curated by Sonatype’s research teams to fill in the gaps and improve accuracy.

- Read [Sonatype's response to MITRE's notice of the potential shutting down of the NVD](https://www.sonatype.com/blog/cve-program-uncertainty) and its impact on Sonatype.

## Common Platform Enumeration (CPE) Vulnerability Detection

CPE identifiers are used to link vulnerabilities (tracked by CVEs) to specific IT products. This allows security teams to determine which of their systems are affected by known vulnerabilities.

The relationship between CPE identifiers and CVEs is crucial for effective vulnerability management. When a vulnerability (CVE) is discovered, the vulnerability database is updated to indicate which CPE identifiers (product names and versions) are vulnerable.

Sonatype follows the CPE 2.3 name matching specification from NIST, to compare CPE names in the vulnerability database. *Sonatype Lifecycle* when configured to use Public Data Sources, can identify CPE names from the ingested Software Bill of Materials (SBOMs) and trigger policy evaluations.

Learn more on how to configure Sonatype Lifecycle to use [Public Data Sources](#UUID-9f8a5cf3-7b45-8a9c-d282-f11640b24fa0) .

## How Sonatype provides high-quality data

There are two considerations for data quality:

- the content of the security advisory
- the precision of associating the content with the correct artifact

Automated decisions require precise identification and corresponding association of security information. Without accurate identification and association, there is a high degree of false positives.

False positives incur unnecessary research and upgrade costs. False negatives leave you at risk because there are no indicators that show you may be at risk. Sonatype uses a combination of automated identification and human research that eliminates false positives and negatives. This results in savings in research time to prove false positives and rework time to upgrade when not required.

## When is vulnerability data available?

Sonatype Data Services is continuously updated, allowing the most recent data to be visible the instant a Lifecycle analysis occurs. This is true for both newly published components and newly discovered security issues. We have two processing queues for security vulnerabilities to ensure they are immediately available to our customers.

### Fast-Track

Our automated vulnerability detection systems process various data sources each day. Upon discovery of an issue, a researcher ensures that an appropriate component was identified, a one-line summary exists, and that the vulnerable version range matches any available advisories. The Fast-Track process generally makes newly discovered vulnerabilities available in less than 24 hours, depending on the severity of the issue.

### Deep Dive

After the Fast-Track process is complete, issues are selected to undergo the Deep Dive process based on our priority queue. During the Deep Dive process, issues undergo source code analysis to ensure there is an accurate vulnerable version range as well as detailed explanations, detections, and recommendations. The Deep Dive process may cause a change to the implicated components, CVSS score, and versions as we validate and correct the data provided from the initial Fast-Track process. Deep Dive generally takes 24 hours but may take up to 3 days for outliers.

### Public Research

This process is specifically designed to ingest CPE vulnerability identifiers directly from the public data sources (NIST.) These CPE vulnerabilities can be detected when you have [configured](#UUID-9f8a5cf3-7b45-8a9c-d282-f11640b24fa0) .

### Vendor Research

SBOMs often include CPEs, which are a critical link between the components listed in the SBOM and the vast ecosystem of vulnerability information.

- In Cyclone DX, CPEs appear in the `cpe` field with the `properties` section of the corresponding component.
- In SPDX, CPEs appear under the `externalReferences` section of the relevant component entry, with a `referenceType` of `SECURITY` .

The CPEs in SBOMs are likely to be third party vulnerabilities that are detected by other vendors or systems (besides Sonatype.)

This process is specifically designed to ingest such vendor detected CPE vulnerabilities These vendor researched CPE vulnerabilities are available when you have [configured](#UUID-9f8a5cf3-7b45-8a9c-d282-f11640b24fa0) .

We aggregate all CPE-derived CVEs for a component to guage its exposure and full scope of the potential vulnerabilities to determine the final risk score.

There is no "refresh time" or delay between completing research and making the results of that research available to you as a customer. As soon as the research is completed, the results of that research will be available in new Lifecycle scans.

## Why some evaluation reports show fewer vulnerabilities

You may notice that some evaluation reports have fewer security violations or some links do not return the same vulnerability data as before. Here are the most common causes:

- The vulnerability was duplicated and consolidated into a single issue
- The vulnerability range is updated during the deep dive to correct the effective range set from fast-track

## When a previously declared vulnerability is disputed or rejected

At Sonatype, we strive for continuous improvement in our vulnerability detection system by maintaining high data quality. As part of continuous data refresh, in addition to new vulnerabilities, we re-evaluate older vulnerability data to determine its security implications in an evolving threat landscape and remove if non-relevant. This reduces false positives and eliminates unnecessary blockers in the development process.

In instances where a vulnerability declared by the NVD is "disputed" or "rejected" by the NVD, Sonatype researchers thoroughly review the vulnerability data, validate and then update in the vulnerability database to reflect the "disputed/rejected" status . These vulnerabilities will not trigger policy violations on future application scans to prevent noise. However, they will still be visible in older application reports corresponding to the scans and evaluations prior to being assigned as disputed, and still be available for in-product lookup.

## Where component data is sourced

Component binaries come from popular public repositories like Central, [NuGet.org](http://nuget.org/) , [npmjs.org](http://npmjs.org/) , Fedora EPEL, and PyPI. We also ingest components directly from GitHub, and other project download sites when nominated by customers.

Binary repositories provide the ability to extract information like declared licenses, popularity, and release history. Additional component metadata comes from a variety of sources including direct research.

## How the vulnerability scores are calculated

When new vulnerabilities are reported from sources other than the NVD, Sonatype uses the [Common Vulnerability Scoring System (CVSS)](https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System) version 4 to score vulnerabilities and assign a vulnerability identifier with the `SONATYPE-` prefix.

Sonatype researchers often come up with the CVSS scores well before the NVD does due to their months-long backlog. These vulnerabilities may not have valid CVSS scores assigned for some time but when updated they may differ from the Sonatype score.

They're both using the same CVSS metric, but the Sonatype researcher came to a different conclusion as to the threat than NVD did. We make our determination after finding and analyzing the fixed code and all available additional resources. It is common and expected that those scores may sometimes be different.

## CVEs not found in Sonatype data

Our vulnerability search feature is used to search for vulnerabilities that exist in components we have ingested into our data. It is not a general lookup for CVEs reported on the [National Vulnerability Database (NVD)](https://nvd.nist.gov/) .

The search does not show vulnerabilities for components we have not ingested.

## Data that Sonatype provides

- The source of the advisory: Sonatype Security Research or the National Vulnerability Database
- The severity of the issue: CVSS and scoring system version and the source of the score creation
- The Common Weakness Enumeration (CWE)
- The exact description from the advisory
- A detailed explanation of the advisory risk and the attack vector (because the advisory description is often very poor)
- How to determine if you are vulnerable
- A recommendation on how to fix or work around the issue
- The root cause of the issue; the exact class and vulnerable version range that was found in your code
- Publicly known attack vectors or exploits; additional resources that describe the exact issue

## Working with Vulnerability Data

The vulnerability data is available on the .

### Component Details Page

In the Application Composition Report, select the violation that you are investigating to open the Component Details Page. Within the Component Details Page, select the Policy Violations tab to view the list of violations for this component.

Select a security policy violation to open the *Violation Details* tile, then scroll down to access the violation details.

![Image of the Policy Violations tab on the Component Details page](/docs-at-surgery-poc/assets/images/uuid-b0d727c7-2362-5d62-a17a-cc5027a7c3e6.png)

The label Deep Dive indicates that this vulnerability data includes details and recommendations from the Sonatype Research Team.

The label Advanced Vulnerability Detection indicates that this vulnerability has been detected in entire files and embedded dependencies, typically beyond the public feeds.

![157680284.png]({{ /assets/images/uuid-2a607799-b885-535f-a6a2-f7914e75590b.png)

### Vulnerability Lookup

From the Vulnerabilities list, you can access detailed information on a given vulnerability by clicking the Vuln ID.

![157680286.png](/docs-at-surgery-poc/assets/images/uuid-058d1dee-ec12-d2a0-679e-da44dc8b2c4f.png)

The Vulnerability Lookup page can also be accessed by selecting Vulnerability Lookup from the IQ Server toolbar:

![157680287.png]({{ /assets/images/uuid-cc8d7de3-3f12-a18a-482d-4fad2e83d034.png)

## Custom Vulnerability Attributes

The security team may augment vulnerability data provided by Sonatype products using custom vulnerability attributes. They may customize the details and attributes of a vulnerability to aid developers in remediation and prioritization.

- Modify the severity score to align with your applications temporal or environmental states.
- Provide research done on a vulnerability and custom remediation instructions for your developers
- Use custom CWE-ID as a policy constraints to enforce remediation or development practices

### Customizing the CVSS Vector String and Severity

The CVSS vector string is a combination of base metrics (reflect the exploitability, impact, and scope of the vulnerability), environmental metrics (reflect the confidentiality), integrity and availability of information systems, and temporal metrics (reflect the exploit code maturity, remediation level, and report confidence).

See the [FIRST.ORG CVSS Specifications](https://www.first.org/cvss/v3.0/specification-document) for details.

- Modify the temporal metrics or environmental metrics to match the specific impact and requirements of your infrastructure
- Override the base metrics with your own research

We have added the ability to add custom CVSS Vector String and Severity. Customizing this data is useful when you want to add temporal or environmental metrics to the CVSS vector string.

For instance, if your developers are using a component vulnerable to [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965) , and you have evidence that a proof of concept exploit exists but also know there is an official fix, you can modify the CVSS vector string to reflect this data.

```
AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
```

to

```
AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
```

The severity should then be adjusted from 9.8 to 8.8 to reflect the temporal information.

Add a new policy with a constraint on the temporal metric representing the "official fix", "RL:O", to require developers prioritize vulnerabilities with an official fix.

### Customizing the Custom Remediation

Provide remediation instructions and research details to developers on a vulnerability.

For example, if your developers are using org.apache.tomcat : tomcat-catalina : 10.0.0-M3 they are susceptible to [CVE-2021-24122](https://ossindex.sonatype.org/vulnerability/CVE-2021-24122?component-type=maven&component-name=org.apache.tomcat/tomcat-catalina) . However, that vulnerability is only accessible if the application is serving resources from a Windows NTFS file system. As part of your custom remediation, you can instruct developers to check with an authorized individual who can validate that they are using the component on a non-Windows NTFS file systems before granting a waiver.

Similarly, the text box can be used to provide proof of research or mitigation. For instance, if your developers are using com.fasterxml.jackson.core : jackson-databind : 2.10.0 it is susceptible to [CVE-2020-9548](https://ossindex.sonatype.org/vulnerability/CVE-2020-9548?component-type=maven&component-name=com.fasterxml.jackson.core/jackson-databind) if developers are still using the deprecated default typing methods from 2.9.x.

Within the custom remediation box the developer may show how they migrated from version 2.9.x to 2.10.0 and that they are no longer calling the deprecated methods. This is done by providing links to a Jira ticket or even links to code commits in SCM. When providing this level of detail it is recommended that changes be scoped to the application, as these details would have to be provided on a per-application basis.

### Customizing the CWE-ID

The CWE-ID is a community-developed list of software and hardware weakness types. The CWE classification and taxonomy serve as a common baseline for weakness identification and remediation efforts across developer and security practitioner communities.

Learn more about CWEs at [mitre.org](https://cwe.mitre.org/about/new_to_cwe.html)

Customize the CWE-IDs to reflect the weakness identification and remediation efforts specifically for your development environment.

By customizing the CWE-ID you have greater control over policy enforcement. For instance, if you have a policy requiring all data query logic to be sanitized (policy constraint on CWE-ID 943) and you have developers using org.hibernate : hibernate-core : 5.4.20.Final which is vulnerable to [CVE-2020-25638](https://ossindex.sonatype.org/vulnerability/CVE-2020-25638?component-type=maven&component-name=org.hibernate/hibernate-core) , you can edit the CWE-ID to also include CWE-ID 943 expanding the default category of CWE-ID 89. Conversely, you could also narrow the category of a hibernate SQL injection weakness and use CWE-ID 564 if you wanted to have policy specifically around vulnerabilities of that category.

### Scopes and Application Category

Customize vulnerability attributes at any scope (ROOT, Organization, or Application) or with an application category. When adding environmental metrics to a CVSS vector string, we recommend applying those changes either on an application category (e.g. air-gapped applications might require "MAV:P" metric), or application scope.

Conversely, temporal metrics can be applied to all scopes so ROOT would be the most common choice. Confirm the applicable scope of your changes before saving the customized vulnerability attributes.

### Steps to Customize Vulnerability Attributes

This feature is available to users with `Edit IQ Elements` permission.

1. Click on the "Customize" button to start customizing the vulnerability details. The "Custom" indicator for the vulnerability attributes in the left panel indicates whether that attribute has been customized previously.

![157681089.png](/docs-at-surgery-poc/assets/images/uuid-2cce7565-31d9-9291-1333-bfbdd642b395.png)

2. A Edit <Vulnerability Attribute>" button on the right top section for each vulnerability attribute appears. Click on the edit button for the vulnerability attribute you want to customize.

![157680899.png](/docs-at-surgery-poc/assets/images/uuid-4d8b9fee-2903-44f4-067d-66df2d43fe47.png)

3. Click on the Edit Remediation Message" to customize the remediation for this vulnerability.

![157681086.png](/docs-at-surgery-poc/assets/images/uuid-13c3dba1-2cfd-572f-5d5f-212f4fb8bc35.png)

Enter the customized remediation message. Select the appropriate scope, i.e. root, organization or application from the dropdown. Select the application category to which this customization will be applicable. Click Save" to complete the customization of the remediation message.

4. Click on "Customize CWE ID" to customize the vulnerability attribute CWE ID.

![157681087.png](/docs-at-surgery-poc/assets/images/uuid-5d4fe618-308c-e010-f2b4-77ae047d6994.png)

Enter the custom CWE ID. Select the appropriate scope, i.e. root, organization or application from the dropdown. Enter the Audit Comments" to explain the reason for customizing this vulnerability attribute. Audit comments will appear in the audit log for traceability and accountability. Click "Save" to complete the customization.

5. Click on "Customize CVSS String " to customize the CVSS strings and severity for this vulnerability.

![157681088.png](/docs-at-surgery-poc/assets/images/uuid-4c80b105-c54c-f922-eeaa-e377ccc12757.png)

Enter the custom CVSS vector string. Select the appropriate scope, i.e. root, organization or application from the dropdown. Enter the Audit Comments" to explain the reason for customizing this vulnerability attribute. Audit comments will appear in the audit log for traceability and accountability. Click "Save" to complete the customization.

6. Click on "Customize CVSS Severity" to customize the CVSS severity for this vulnerability.

![157681090.png](/docs-at-surgery-poc/assets/images/uuid-0fb00563-9136-5793-8857-a0d2ca7428d4.png)

Enter the custom CVSS severity. Select the appropriate scope, i.e. root, organization or application from the dropdown. Enter the Audit Comments" to explain the reason for customizing this vulnerability attribute. Audit comments will appear in the audit log for traceability and accountability. Click "Save" to complete the customization.
